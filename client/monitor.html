<!--
    Copyright (C) 2022  Schmuel Odradek
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; version 3.
    DSBLSP is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

    This product is a WIP. There are still a lot things to be done.
    The current version of the software is not meant to be already daily-driven
    in schools or companies.

    TODO: 
    - Improve relative positioning on screen (Maybe Font mastering?)
    - Design account System (login and password) to prevent abuse
    - Set Design standards
    - Improve performance by Raphael-handling

-->

<html style="width: 100%; height: 100%; margin: 0; overflow: hidden;">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <title>Digitales Schwarzes Brett</title>
    </head>

    <body style="width: 100%; height: 100%; margin: 0; overflow: hidden;">
        <!--<canvas id="ctx" style="border:1px solid #000; background-color: #000"></canvas>-->


        <!--Scripts down here-->
        <script src="/socket.io/socket.io.js"></script>
        <script src="js/raphael/raphael.js"></script>
        <script>
   

            var socket = io();

            var paper = Raphael(0, 0, window.innerWidth, window.innerHeight);

            socket.on("recentData",function(data){

                /*
                    This section is about aligning the elements on the paper correctly.
                    It sets the preferences of the background and style elements.
                    The for-loop iterates thru every Element of the received Dataset
                    and prints it to the Screen.

                    TODO: Only refresh the Text. Background and layout could be static to improve performance.
                */
                paper.clear();
                var elements = []
                var bg = paper.rect(0, 0, window.innerWidth, window.innerHeight);
                var siteBarWhite = paper.rect(0.98*paper.width, 0, 0.01*paper.width, paper.height);
                var siteBarViolet = paper.rect(0.99*paper.width, 0, 0.01*paper.width, paper.height);

                for (var i = 0; i<data.length; i++){
                    x=data[i].x*paper.width;
                    y=data[i].y*paper.height;

                    paper.text(x, y, data[i].text).attr({
                        fill: "white",
                        font: "Arial",
                        "font-size": Math.floor(0.033*paper.height),
                        "text-anchor": "start"
                    })
                }


                /*
                    This section defines the attributes of the elements on the screen.
                    Right now they are refreshed every frame. This should be static too.
                    (TODO)
                */
                bg.attr({
                    fill: "black"
                });
                siteBarWhite.attr({
                    fill: "white",
                    stroke: "white"
                });
                siteBarViolet.attr({
                    fill: "#571c5b",
                    stroke: "#571c5b"
                });

            });

            socket.on("serverLog", function(data){
                console.log(data.log);
            });
        
        </script>

    </body>
</html>